webpackJsonp([5],{"2KJx":function(e,r){},O0tc:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("3cXf"),a=t.n(o),s=t("aA9S"),i=t.n(s),n=t("4YfN"),l=t.n(n),p=t("yADF"),c=t("5mDR"),u=t("OOvn"),m=(t("/ADh"),t("fUgm")),d={components:{lxUploadImg:p.a,lxBackpage:c.a},data:function(){var e=this;return{props:{lazy:!0,label:"name",emitPath:!1,checkStrictly:!0,value:"orgCode",lazyLoad:function(r,t){e.getOrganization(r,t)}},props1:{lazy:!0,label:"name",emitPath:!1,multiple:!0,value:"orgCode",checkStrictly:!0,lazyLoad:function(r,t){e.getOrganization(r,t)}},enterpriseForm:{id:void 0,description:"",function:"employee",mobile:"",note:"",orgCode:"",passWord:"123456",powerOrgCodes:[],realName:"",role:[],status:1,userName:"",userType:0,loginAvailable:""},rules:{userName:[{required:!0,message:"用户名不能为空",trigger:"change"}],realName:[{required:!0,message:"用户姓名不能为空",trigger:"change"}],mobile:[{required:!0,message:"手机号码不能为空",trigger:"change"}],orgCode:[{required:!0,message:"请选择所属组织",trigger:"change"}],function:[{required:!0,message:"请选择职能",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},powerOrgCodes:"",dialogVisible:!1,butLoading:!1,rolesList:[]}},watch:{},computed:l()({},Object(m.c)({includePages:function(e){return e.includePages},userInfo:function(e){return e.userInfo}})),created:function(){var e=this,r=i()({},this.$route.params.data);this.$route.params.data&&(r.powerOrgCodes?r.powerOrgCodes=r.powerOrgCodes.split(",").map(function(e,t){return{orgCode:e,name:r.powerOrgCodeNames[t]}}):r.powerOrgCodes=[],this.enterpriseForm={id:r.id,description:r.description,function:r.function,mobile:r.mobile,note:r.note,orgCode:[r.orgCode],passWord:void 0,powerOrgCodes:r.powerOrgCodes,realName:r.realName,role:r.role?r.role.split(","):[],status:r.status,userName:r.userName,userType:r.userType,loginAvailable:!!r.loginAvailable}),Object(u.F)({page:0,size:1e3}).then(function(r){var t=r.data;0===t.subCode&&(e.rolesList=t.data)})},mounted:function(){},beforeRouteLeave:function(e,r,t){if("/system/userManage"!=e.path){var o=JSON.parse(a()(this.includePages));this.$store.commit("setInclude",o.filter(function(e){return"userManage"!=e}))}t()},methods:{getOrganization:function(e,r){0===e.level&&(e.data={name:"服务号中心",id:1e9,level:0,orgCode:null}),Object(u.C)({level:e.level+1,page:0,size:1e4,queryAbout:1,parentOrgCode:e.data.orgCode?e.data.orgCode:null}).then(function(t){var o=t.data;if(0===o.subCode)return o.data.map(function(e){e.disabled=1!=e.status}),2==e.level&&o.data.map(function(e){e.leaf=!0}),r(o.data)})},addPower:function(){this.dialogVisible=!0,this.powerOrgCodes=""},addPowerOrgCodes:function(){var e=this;this.dialogVisible=!1,this.$refs.cascader.getCheckedNodes().map(function(r){-1==e.enterpriseForm.powerOrgCodes.map(function(e){return e.orgCode}).indexOf(r.value)&&e.enterpriseForm.powerOrgCodes.push({orgCode:r.value,name:(r.parent?(r.parent.parent?r.parent.parent.label+">":"")+r.parent.label+">":"")+r.label})})},handleClose:function(e){this.enterpriseForm.powerOrgCodes.splice(e,1)},save:function(){var e=this;this.$refs.form.validate(function(r){if(r){e.butLoading=!0;var t=i()({},e.enterpriseForm);t.loginAvailable=t.loginAvailable?["MANAGER"]:void 0,t.powerOrgCodes=t.powerOrgCodes.map(function(e){return e.orgCode}),t.id?(t.createUser=e.userInfo.userView.name,t.orgCode=t.orgCode[0],Object(u.N)(l()({},t)).then(function(r){var t=r.data;e.butLoading=!1,0==t.subCode?(e.$message.success(t.message),sessionStorage.oneApi=1,e.$router.go(-1)):e.$message.error(t.message)})):(t.createrUser=e.userInfo.userView.name,Object(u.e)(l()({},t)).then(function(r){var t=r.data;e.butLoading=!1,0==t.subCode?(e.$message.success(t.message),sessionStorage.oneApi=1,e.$router.go(-1)):e.$message.error(t.message)}))}})}}},g={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"commonClass"},[t("lxBackpage",{attrs:{title:"添加用户"}}),e._v(" "),t("el-form",{ref:"form",attrs:{size:"medium",model:e.enterpriseForm,rules:e.rules,"label-width":"200px"}},[t("el-form-item",{attrs:{prop:"userName",label:"用户名："}},[t("el-input",{attrs:{disabled:!!e.enterpriseForm.id,clearable:"",maxlength:"30",placeholder:"请输入不超过30字"},model:{value:e.enterpriseForm.userName,callback:function(r){e.$set(e.enterpriseForm,"userName","string"==typeof r?r.trim():r)},expression:"enterpriseForm.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"realName",label:"用户姓名："}},[t("el-input",{attrs:{clearable:"",maxlength:"30",placeholder:"请输入不超过30字"},model:{value:e.enterpriseForm.realName,callback:function(r){e.$set(e.enterpriseForm,"realName","string"==typeof r?r.trim():r)},expression:"enterpriseForm.realName"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"role",label:"用户角色："}},[t("el-select",{staticClass:"width100",attrs:{clearable:"",multiple:""},on:{change:function(r){e.enterpriseForm.userType=-1!=e.enterpriseForm.role.indexOf("业务人员")?1:0}},model:{value:e.enterpriseForm.role,callback:function(r){e.$set(e.enterpriseForm,"role",r)},expression:"enterpriseForm.role"}},e._l(e.rolesList,function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"mobile",label:"手机号码："}},[t("el-input",{attrs:{clearable:"",maxlength:"11",placeholder:"请输入手机号码"},model:{value:e.enterpriseForm.mobile,callback:function(r){e.$set(e.enterpriseForm,"mobile",e._n(r))},expression:"enterpriseForm.mobile"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"orgCode",label:"所属组织："}},[t("el-cascader",{staticClass:"width100",attrs:{disabled:!!e.enterpriseForm.id,clearable:"",filterable:"",props:e.props},model:{value:e.enterpriseForm.orgCode,callback:function(r){e.$set(e.enterpriseForm,"orgCode",r)},expression:"enterpriseForm.orgCode"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数据权限："}},[t("el-button",{staticStyle:{"margin-bottom":"10px"},on:{click:e.addPower}},[e._v("添加")]),e._v(" "),t("br"),e._v(" "),e._l(e.enterpriseForm.powerOrgCodes,function(r,o){return t("el-tag",{key:o,staticStyle:{"margin-right":"10px"},attrs:{size:"medium",closable:""},on:{close:function(r){return e.handleClose(o)}}},[e._v(e._s(r.name))])})],2),e._v(" "),t("el-form-item",{attrs:{prop:"function",label:"职能："}},[t("el-radio",{attrs:{label:"employee"},model:{value:e.enterpriseForm.function,callback:function(r){e.$set(e.enterpriseForm,"function",r)},expression:"enterpriseForm.function"}},[e._v("员工")]),e._v(" "),t("el-radio",{attrs:{label:"director"},model:{value:e.enterpriseForm.function,callback:function(r){e.$set(e.enterpriseForm,"function",r)},expression:"enterpriseForm.function"}},[e._v("主管")])],1),e._v(" "),t("el-form-item",{attrs:{prop:"status",label:"用户状态："}},[t("el-radio",{attrs:{label:1},model:{value:e.enterpriseForm.status,callback:function(r){e.$set(e.enterpriseForm,"status",r)},expression:"enterpriseForm.status"}},[e._v("启用")]),e._v(" "),t("el-radio",{attrs:{label:0},model:{value:e.enterpriseForm.status,callback:function(r){e.$set(e.enterpriseForm,"status",r)},expression:"enterpriseForm.status"}},[e._v("禁用")])],1),e._v(" "),t("el-form-item",{attrs:{prop:"userType",label:"业务人员："}},[t("el-radio",{attrs:{disabled:"",label:1},model:{value:e.enterpriseForm.userType,callback:function(r){e.$set(e.enterpriseForm,"userType",r)},expression:"enterpriseForm.userType"}},[e._v("是")]),e._v(" "),t("el-radio",{attrs:{disabled:"",label:0},model:{value:e.enterpriseForm.userType,callback:function(r){e.$set(e.enterpriseForm,"userType",r)},expression:"enterpriseForm.userType"}},[e._v("否")])],1),e._v(" "),t("el-form-item",{attrs:{label:"登录平台："}},[t("el-checkbox",{model:{value:e.enterpriseForm.loginAvailable,callback:function(r){e.$set(e.enterpriseForm,"loginAvailable",r)},expression:"enterpriseForm.loginAvailable"}},[e._v("运营管理平台")])],1),e._v(" "),t("el-form-item",{attrs:{label:"描述："}},[t("el-input",{attrs:{clearable:"",maxlength:"1000",placeholder:"请输入"},model:{value:e.enterpriseForm.description,callback:function(r){e.$set(e.enterpriseForm,"description","string"==typeof r?r.trim():r)},expression:"enterpriseForm.description"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"操作备注："}},[t("el-input",{attrs:{clearable:"",maxlength:"1000",placeholder:"请输入"},model:{value:e.enterpriseForm.note,callback:function(r){e.$set(e.enterpriseForm,"note","string"==typeof r?r.trim():r)},expression:"enterpriseForm.note"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{loading:e.butLoading,type:"primary"},on:{click:e.save}},[e._v("确 定")]),e._v(" "),t("el-button",{on:{click:function(r){return e.$router.go(-1)}}},[e._v("取 消")])],1)],1),e._v(" "),t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"组织选择",visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(r){e.dialogVisible=r}}},[t("el-cascader",{ref:"cascader",staticClass:"width100",attrs:{clearable:"",filterable:"",props:e.props1},model:{value:e.powerOrgCodes,callback:function(r){e.powerOrgCodes=r},expression:"powerOrgCodes"}}),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{nativeOn:{click:function(r){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary",disabled:!e.powerOrgCodes},on:{click:e.addPowerOrgCodes}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var f=t("C7Lr")(d,g,!1,function(e){t("Uwca")},"data-v-61bfa168",null);r.default=f.exports},Uwca:function(e,r){},yADF:function(e,r,t){"use strict";var o=t("OOvn"),a={components:{},data:function(){return{imgUrl:""}},watch:{},computed:{},created:function(){},mounted:function(){},methods:{beforeAvatarUpload:function(e){var r=e.size/1024/1024<5;return r||this.$message.error("证件图片大小不能超过 5MB!"),r},uploadSectionFile:function(e){var r=this,t=new FormData;this.imgUrl="345",t.append("resourceType",1),t.append("published","N"),t.append("organization",""),t.append("file",e.file),Object(o.O)(t).then(function(e){var t=e.data;0===t.subCode&&(r.imgUrl=t.data.resourceUrl,r.$emit("getUrl",t.data))})},fileRemove:function(e){this.imgUrl="",this.$emit("getUrl","")}}},s={render:function(){var e=this.$createElement,r=this._self._c||e;return r("div",[r("el-upload",{key:"formUpload",staticClass:"avatar-uploader",class:{isHidden:this.imgUrl},attrs:{action:"","before-upload":this.beforeAvatarUpload,"http-request":this.uploadSectionFile,"list-type":"picture-card","on-remove":this.fileRemove,drag:!0,accept:"image/jpeg, image/png, image/jpg"}},[r("i",{staticClass:"el-icon-plus"})]),this._v(" "),r("p",{staticStyle:{color:"#999"}},[this._v("图片格式为 jpg, bmp、png和jpeg，大小不超过5M。")])],1)},staticRenderFns:[]};var i=t("C7Lr")(a,s,!1,function(e){t("2KJx")},"data-v-7211ef16",null);r.a=i.exports}});