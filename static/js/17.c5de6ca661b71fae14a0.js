webpackJsonp([17],{VryI:function(e,t){},dgG5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("aA9S"),o=n.n(a),s=n("3cXf"),i=n.n(s),r=n("4YfN"),c=n.n(r),l=n("OOvn"),m=n("Ap6m"),p=n("+ThO"),u=n("vqMG"),g=(n("/ADh"),n("fUgm")),d={name:"enterprise",components:{searchForm:m.a,pagination:p.a,lxTable:u.a},data:function(){var e=this;return{formOptions:[{label:"公司名称",prop:"companyName",element:"el-input"},{label:"企业编码",prop:"companyCode",element:"el-input"},{label:"紧急联系人",prop:"merchantContact",element:"el-input"},{label:"紧急联系方式",prop:"merchantTel",element:"el-input"},{label:"主账号",prop:"mainAccount",element:"el-input"},{label:"主账号状态",prop:"mainAccountState",element:"el-select",options:[{label:"待完善",value:0},{label:"待开通",value:1},{label:"正常使用",value:2},{label:"停止使用",value:3}]},{label:"提交时间",prop:"operTimes",element:"el-date-picker"}],tableList:[{label:"公司名称",prop:"companyName",align:"center"},{label:"企业编码",prop:"companyCode",align:"center"},{label:"企业紧急联系人",prop:"merchantContact",align:"center"},{label:"企业紧急联系人方式",prop:"merchantTel",align:"center"},{label:"主账号（手机号）",prop:"mainAccount",align:"center"},{label:"主账号状态",prop:"mainAccountState",align:"center",render:function(e,t){return e("span",{style:{color:2!=t.row.mainAccountState?"red":"rgb(1, 128, 1)"},domProps:{innerHTML:0==t.row.mainAccountState?"待完善":1==t.row.mainAccountState?"待开通":2==t.row.mainAccountState?"正常使用":"停止使用"}})}},{label:"提交时间",prop:"operTime",align:"center",sort:"custom"},{label:"操作",prop:"",align:"center",width:300,render:function(t,n){return t("div",{class:{operation:!0}},[t("el-tag",{domProps:{innerHTML:"查看"},on:{click:function(){e.seeInfo(n.row)}}}),t("el-popconfirm",{props:{type:"success",title:"重置此企业的密码为123456?"},slot:"reference",on:{onConfirm:function(){e.resetPassword(n.row)}}},[t("el-tag",{props:{type:"warning"},slot:"reference",domProps:{innerHTML:"重置密码"}})]),t("el-tag",{props:{type:"success"},style:{display:1!==n.row.mainAccountState?"none":""},domProps:{innerHTML:"主账号开通"},on:{click:function(){e.mainOpen(n.row)}}}),t("el-tag",{props:{type:"info"},style:{display:n.row.mainAccountState?"none":""},domProps:{innerHTML:"完善主账号"},on:{click:function(){e.mainPerfect(n.row)}}}),t("el-tag",{props:{type:"danger"},style:{display:2!==n.row.mainAccountState?"none":""},domProps:{innerHTML:"停用主账号"},on:{click:function(){e.mainStop(n.row,1)}}}),t("el-tag",{props:{type:"info"},style:{display:3!==n.row.mainAccountState?"none":""},domProps:{innerHTML:"启用主账号"},on:{click:function(){e.mainStop(n.row,2)}}})])}}],tableData:[],pages:{page:0,size:10,total:0},searchForm:{},tableLoading:!1,addShow:!1,modelForm:{companyName:"",creditType:"",creditNumber:"",license:"",mainAccount:"",merchantContact:"",merchantTel:"",merchantEmail:"",operateType:1,callbackAddr:"",comBusinessAccount:"",comBusinessContact:"",comBusinessOrgCode:"",orgName:""},isEdit:!1,button_loading:!1,userList:[],formOptionsType:[],sortRules:[]}},watch:{},computed:c()({},Object(g.c)({includePages:function(e){return e.includePages}})),created:function(){var e=this;this.getUserlist(),Object(l.t)({page:0,size:1e5}).then(function(t){var n=t.data;0===n.subCode?e.userList=n.data:e.message.error(n.message)}).catch(function(e){});var t=JSON.parse(i()(this.includePages));t.push("enterprise"),this.$store.commit("setInclude",t)},activated:function(){1==sessionStorage.oneApi&&(this.getUserlist(),sessionStorage.removeItem("oneApi"))},mounted:function(){},beforeRouteLeave:function(e,t,n){if("/enterprise/create"!=e.path&&"/enterprise/see"!=e.path){var a=JSON.parse(i()(this.includePages));this.$store.commit("setInclude",a.filter(function(e){return"enterprise"!=e}))}n()},methods:{getUserlist:function(){var e=this;this.tableLoading=!0;var t=o()({},{page:this.pages.page,size:this.pages.size},this.searchForm);this.sortRules.length>0&&(t.sortRules=this.sortRules),Object(l.v)(c()({},t)).then(function(t){var n=t.data;e.tableLoading=!1,0===n.subCode&&(e.tableData=n.data,e.pages=n.pageInfo)})},onSearch:function(e){this.searchForm=o()({},e),this.pages.page=0,this.getUserlist()},changeSize:function(e){this.pages=e,this.getUserlist()},resetPassword:function(e){var t=this;this.tableLoading=!0,Object(l.o)({mobile:e.mainAccount}).then(function(e){var n=e.data;t.tableLoading=!1,0===n.subCode?(t.$message.success(n.message),t.getUserlist()):t.$message.error(n.message)})},mainOpen:function(e){var t=this;this.$confirm("确定开通 “"+e.companyName+"“ 的主账号？","主账号开通",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",beforeClose:function(n,a,o){"confirm"===n?(a.confirmButtonLoading=!0,Object(l.q)({companyCode:e.companyCode,companyName:e.companyName,id:e.id,mainAccount:e.mainAccount,orgCode:e.orgCode,realName:e.mainAccount}).then(function(e){var n=e.data;a.confirmButtonLoading=!1,0===n.subCode?(o(),t.$message.success(n.message),t.getUserlist()):t.$message.error(n.message)})):o()}}).then(function(){}).catch(function(){})},mainStop:function(e,t){var n=this;this.$confirm("确定"+(1==t?"停用":"启用")+" “"+e.companyName+"“ 的账号？",(1==t?"停用":"启用")+"主账号",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",beforeClose:function(a,o,s){"confirm"===a?(o.confirmButtonLoading=!0,Object(l.r)({companyCode:e.companyCode,id:e.id,mainAccount:e.mainAccount,orgCode:e.orgCode,operateType:1==t?12:11,realName:e.mainAccount}).then(function(e){var t=e.data;o.confirmButtonLoading=!1,0===t.subCode?(s(),n.$message.success(t.message),n.getUserlist()):n.$message.error(t.message)})):s()}}).then(function(){}).catch(function(){})},mainPerfect:function(e){var t=this;this.$prompt("主账号手机号","完善企业主账户",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[1][3,4,5,6,7,8,9][0-9]{9}$/,inputErrorMessage:"手机号码不正确",beforeClose:function(n,a,o){"confirm"===n?(a.confirmButtonLoading=!0,Object(l.g)({id:e.id,mainAccount:a.inputValue}).then(function(e){var n=e.data;a.confirmButtonLoading=!1,0===n.subCode?(o(),t.$message.success(n.message),t.getUserlist()):t.$message.error(n.message)})):o()}}).then(function(){}).catch(function(){})},seeInfo:function(e){this.$router.push({name:"enterpriseSee",params:{data:e}})},sortChange:function(e){this.sortRules=e,this.getUserlist()}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"commonClass messagemodal"},[n("div",{staticClass:"commonClass-right"},[n("div",{staticClass:"commonClass-right-title"},[n("p",{staticClass:"commonClass-right-title-left"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),n("el-button",{staticClass:"commonClass-right-title-right",attrs:{type:"primary"},nativeOn:{click:function(t){return e.$router.push("/enterprise/create")}}},[n("i",{staticClass:"el-icon-plus"}),e._v("创建企业")])],1),e._v(" "),n("div",{staticClass:"el-card-body"},[n("searchForm",{attrs:{formOptions:e.formOptions},on:{onSearch:e.onSearch}}),e._v(" "),n("lxTable",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{tableData:e.tableData,tableList:e.tableList},on:{sortChange:e.sortChange}}),e._v(" "),n("pagination",{attrs:{page:e.pages.page,size:e.pages.size,total:e.pages.total},on:{getPaginationData:e.changeSize}})],1)])])},staticRenderFns:[]};var h=n("C7Lr")(d,f,!1,function(e){n("VryI")},"data-v-71ba2439",null);t.default=h.exports}});