webpackJsonp([16],{DhAQ:function(e,t){},IwF6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("4YfN"),s=a.n(n),o=a("aA9S"),r=a.n(o),i=a("3cXf"),l=a.n(i),c=a("OOvn"),d=a("Ap6m"),p=a("+ThO"),u=a("vqMG"),g={name:"userManage",components:{searchForm:d.a,pagination:p.a,lxTable:u.a},data:function(){var e=this;return{treeLoading:!1,tableLoading:!1,searchVal:"",organnizationList:[],organizationForm:{name:"",note:"",realName:"",status:0},clickData:{data:{name:"服务号中心",id:null,level:0,status:1}},formOptions:[{label:"用户",prop:"userName",element:"el-input"},{label:"姓名",prop:"realName",element:"el-input"},{label:"手机号码",prop:"mobile",element:"el-input"},{label:"状态",prop:"status",element:"el-select",options:[{label:"启用",value:1},{label:"禁用",value:0}]}],tableList:[{label:"用户名",prop:"userName",align:"center"},{label:"姓名",prop:"realName",align:"center"},{label:"角色",prop:"role",align:"center",type:"el-tag",effect:"dark"},{label:"手机号码",prop:"mobile",align:"center"},{label:"所属组织",prop:"orgName",align:"center",color:"rgb(45, 183, 245)",type:"el-tag",effect:"dark"},{label:"状态",prop:"companyName",align:"center",render:function(e,t){return e("el-tag",{props:{type:1==t.row.status?"success":"danger"},domProps:{innerHTML:1==t.row.status?"启用":"禁用"}})}},{label:"操作",prop:"companyName",width:300,align:"center",render:function(t,a){return"admin"===a.row.userName||"callback"===a.row.userName?t("span",{domProps:{innerHTML:"-"}}):t("div",{class:{operation:!0}},[t("el-tag",{domProps:{innerHTML:"查看"},on:{click:function(){e.seeInfo(a.row)}}}),t("el-tag",{props:{type:"warning"},domProps:{innerHTML:"修改"},on:{click:function(){e.$router.push({name:"userManageCreate",params:{data:a.row}})}}}),t("el-popconfirm",{style:{display:1!=a.row.status?"":"none"},props:{title:"是否要启用”"+a.row.realName+"“的账号"},on:{onConfirm:function(){e.setUser(a.row,1)}}},[t("el-tag",{slot:"reference",domProps:{innerHTML:"启用"},props:{type:"success"}})]),t("el-popconfirm",{style:{display:1==a.row.status?"":"none"},props:{title:"是否要禁用”"+a.row.realName+"“的账号"},on:{onConfirm:function(){e.setUser(a.row,2)}}},[t("el-tag",{slot:"reference",domProps:{innerHTML:"禁用"},props:{type:"danger"}})]),t("el-popconfirm",{props:{title:"初始化”"+a.row.realName+"“的密码为123456"},on:{onConfirm:function(){e.initPassword(a.row)}}},[t("el-tag",{slot:"reference",domProps:{innerHTML:"初始化密码"},props:{type:"info"}})])])}}],tableData:[],pages:{page:0,size:10,total:0},searchForm:{}}},created:function(){this.getUserlist();var e=JSON.parse(l()(this.includePages));e.push("userManage"),this.$store.commit("setInclude",e)},computed:{includePages:function(){return this.$store.state.includePages}},activated:function(){1==sessionStorage.oneApi&&(this.getUserlist(),sessionStorage.removeItem("oneApi"))},mounted:function(){},watch:{},beforeRouteLeave:function(e,t,a){if("/system/userManage/see"!=e.path&&"/system/userManage/create"!=e.path){var n=JSON.parse(l()(this.includePages));this.$store.commit("setInclude",n.filter(function(e){return"userManage"!=e}))}a()},methods:{getUserlist:function(){var e=this;this.tableLoading=!0;var t=r()({},{orgCode:this.clickData.data.orgCode,page:this.pages.page,size:this.pages.size},this.searchForm);Object(c.t)(s()({},t)).then(function(t){var a=t.data;e.tableLoading=!1,0===a.subCode&&(e.tableData=a.data,e.pages=a.pageInfo)})},onSearch:function(e){this.searchForm=r()({},e),this.pages.page=0,this.getUserlist()},changeSize:function(e){this.pages=e,this.getUserlist()},handleNodeClick:function(e,t){this.clickData=t,this.getUserlist()},loadNode:function(e,t){if(0===e.level)return t([{name:"服务号中心",id:1e9,level:0,orgCode:null}]);Object(c.C)({level:e.level,page:0,size:1e4,queryAbout:1,parentOrgCode:e.data.orgCode?e.data.orgCode:null}).then(function(a){var n=a.data;if(0===n.subCode)return 3==e.level&&n.data.map(function(e){e.leaf=!0}),t(n.data)})},search:function(){var e=this;this.treeLoading=!0,Object(c.A)({keyWords:this.searchVal}).then(function(t){var a=t.data;e.treeLoading=!1,0===a.subCode&&(a.data.map(function(e){e.children=null}),e.$refs.tree.updateKeyChildren(1e9,a.data))})},initPassword:function(e){var t=this;Object(c.o)({id:e.id}).then(function(e){0==e.data.subCode&&(t.$message.success("初始化成功"),t.getUserlist())})},setUser:function(e,t){var a=this;1==t?Object(c.a)({id:e.id}).then(function(e){0==e.data.subCode&&(a.$message.success("启用成功"),a.getUserlist())}):Object(c.k)({id:e.id}).then(function(e){0==e.data.subCode&&(a.$message.success("禁用成功"),a.getUserlist())})},seeInfo:function(e){this.$router.push({name:"userManageSee",params:{data:e}})}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"commonClass organization"},[a("div",{staticClass:"organization-left"},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"tree",attrs:{"node-key":"id",lazy:"",props:{isLeaf:"leaf"},load:e.loadNode,"default-expanded-keys":[1e9],"expand-on-click-node":!1},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var n=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{class:"custom-tree-node-span"+(0==n.status?" custom-tree-node-disabled":"")},[e._v(e._s(n.name))])])}}])})],1),e._v(" "),a("div",{staticClass:"organization-right"},[a("div",{staticClass:"commonClass-right-title"},[a("p",{staticClass:"commonClass-right-title-left"},[e._v("用户列表")]),e._v(" "),a("el-button",{staticClass:"commonClass-right-title-right",attrs:{type:"primary"},nativeOn:{click:function(t){return e.$router.push({name:"userManageCreate"})}}},[a("i",{staticClass:"el-icon-plus"}),e._v("新增用户")])],1),e._v(" "),a("div",{staticClass:"el-card-body"},[a("searchForm",{attrs:{formOptions:e.formOptions},on:{onSearch:e.onSearch}}),e._v(" "),a("lxTable",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{tableList:e.tableList,tableData:e.tableData}}),e._v(" "),a("pagination",{attrs:{page:e.pages.page,size:e.pages.size,total:e.pages.total},on:{getPaginationData:e.changeSize}})],1)])])},staticRenderFns:[]};var f=a("C7Lr")(g,m,!1,function(e){a("DhAQ")},null,null);t.default=f.exports}});